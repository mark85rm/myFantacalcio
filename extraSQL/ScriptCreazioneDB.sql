-- Dumping database structure for mark85rm_fantacalcio
DROP DATABASE IF EXISTS `MARK85RM_FANTACALCIO`;
CREATE DATABASE IF NOT EXISTS `MARK85RM_FANTACALCIO` ;
USE `MARK85RM_FANTACALCIO`;

-- DUMPING STRUCTURE FOR TABLE MARK85RM_FANTACALCIO.RUOLIGIOCATORI
DROP TABLE IF EXISTS `RUOLIGIOCATORI`;
CREATE TABLE IF NOT EXISTS `RUOLIGIOCATORI` (
  `ID` INT(10) NOT NULL AUTO_INCREMENT,
  `NOME` VARCHAR(100) DEFAULT NULL,
  PRIMARY KEY (`ID`)
) ENGINE=InnoDB AUTO_INCREMENT=5 DEFAULT CHARSET=utf8;


-- Dumping structure for table mark85rm_fantacalcio.utenti
DROP TABLE IF EXISTS `UTENTI`;
CREATE TABLE IF NOT EXISTS `UTENTI` (
  `ID` BIGINT(10) NOT NULL AUTO_INCREMENT,
  `USERNAME` VARCHAR(50) NOT NULL,
  `PASSWORD` VARCHAR(50) NOT NULL,
  `NOME` VARCHAR(100) DEFAULT NULL,
  `COGNOME` VARCHAR(100) DEFAULT NULL,
  `SQUADRA` INT(11) DEFAULT NULL,
  `MAIL` VARCHAR(100) DEFAULT NULL,
  `ENABLED` TINYINT(1) DEFAULT '0',
  PRIMARY KEY (`ID`)
) ENGINE=InnoDB AUTO_INCREMENT=17 DEFAULT CHARSET=utf8;

-- Dumping structure for table mark85rm_fantacalcio.leghe
DROP TABLE IF EXISTS `LEGHE`;
CREATE TABLE IF NOT EXISTS `LEGHE` (
  `IDLEGA` INT(10) NOT NULL AUTO_INCREMENT,
  `NOMELEGA` VARCHAR(500) DEFAULT NULL,
  `UTENTEAMMINISTRATORE` BIGINT(10) DEFAULT NULL,
  `ENABLED` TINYINT(4) DEFAULT NULL,
  PRIMARY KEY (`IDLEGA`),
  KEY `FK_LEGHE_UTENTE` (`UTENTEAMMINISTRATORE`),
  CONSTRAINT `FK_LEGHE_UTENTE` FOREIGN KEY (`UTENTEAMMINISTRATORE`) REFERENCES `UTENTI` (`ID`) ON DELETE SET NULL
) ENGINE=InnoDB AUTO_INCREMENT=4 DEFAULT CHARSET=utf8;

-- Dumping structure for table mark85rm_fantacalcio.squadre
DROP TABLE IF EXISTS `SQUADRE`;
CREATE TABLE IF NOT EXISTS `SQUADRE` (
  `CODICE` INT(11) NOT NULL AUTO_INCREMENT,
  `NOME` VARCHAR(50) DEFAULT NULL,
  `LEGA` INT(11) DEFAULT NULL,
  PRIMARY KEY (`CODICE`),
  KEY `FK_LEGA_SQUADRE` (`LEGA`),
  CONSTRAINT `FK_LEGA_SQUADRE` FOREIGN KEY (`LEGA`) REFERENCES `LEGHE` (`IDLEGA`)
) ENGINE=InnoDB AUTO_INCREMENT=22 DEFAULT CHARSET=utf8;

-- Dumping structure for table mark85rm_fantacalcio.giocatori
DROP TABLE IF EXISTS `GIOCATORI`;
CREATE TABLE IF NOT EXISTS `GIOCATORI` (
  `IDGIOCATORE` int(11) NOT NULL,
  `NOME` varchar(50) DEFAULT NULL,
  `SQUADRA` varchar(50) DEFAULT NULL,
  `IDFANTASQUADRA` INT(11) DEFAULT NULL,
  `IDRUOLO` INT(11) DEFAULT NULL,
  PRIMARY KEY (`IDGIOCATORE`),
  KEY `FK_RUOLI_GIOCATORI` (`IDRUOLO`),
  KEY `FK_SQUADRA_GIOCATORI` (`IDFANTASQUADRA`),
  CONSTRAINT `FK_RUOLI_GIOCATORI` FOREIGN KEY (`IDRUOLO`) REFERENCES `RUOLIGIOCATORI` (`ID`),
  CONSTRAINT `FK_SQUADRA_GIOCATORI` FOREIGN KEY (`IDFANTASQUADRA`) REFERENCES `SQUADRE` (`CODICE`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


-- Dumping structure for table mark85rm_fantacalcio.giocatori_squadre
DROP TABLE IF EXISTS `GIOCATORI_SQUADRE`;
CREATE TABLE IF NOT EXISTS `GIOCATORI_SQUADRE` (
  `IDGIOCATORE` INT(11) NOT NULL,
  `IDSQUADRA` INT(11) NOT NULL,
  PRIMARY KEY (`IDGIOCATORE`,`IDSQUADRA`),
  KEY `FK_IDSQUADRA_SQUADRE` (`IDSQUADRA`),
  CONSTRAINT `FK_IDGIOCATORE_GIOCATORI` FOREIGN KEY (`IDGIOCATORE`) REFERENCES `GIOCATORI` (`IDGIOCATORE`),
  CONSTRAINT `FK_IDSQUADRA_SQUADRE` FOREIGN KEY (`IDSQUADRA`) REFERENCES `SQUADRE` (`CODICE`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

ALTER TABLE `UTENTI` ADD CONSTRAINT `FK_SQUADRA_UTENTI` FOREIGN KEY (`SQUADRA`) REFERENCES `SQUADRE` (`CODICE`) ON DELETE CASCADE;


-- Dumping structure for table mark85rm_fantacalcio.ruoli
DROP TABLE IF EXISTS `RUOLI`;
CREATE TABLE IF NOT EXISTS `RUOLI` (
  `ID` INT(10) NOT NULL AUTO_INCREMENT,
  `NOME` VARCHAR(100) DEFAULT NULL,
  PRIMARY KEY (`ID`)
) ENGINE=InnoDB AUTO_INCREMENT=3 DEFAULT CHARSET=utf8;

-- Dumping data for table mark85rm_fantacalcio.ruoli: ~2 rows (approximately)
DELETE FROM `RUOLI`;
/*!40000 ALTER TABLE `RUOLI` DISABLE KEYS */;
INSERT INTO `RUOLI` (`ID`, `NOME`) VALUES
	(1, 'ROLE_ADMIN'),
	(2, 'ROLE_USER');
/*!40000 ALTER TABLE `RUOLI` ENABLE KEYS */;




-- Dumping data for table mark85rm_fantacalcio.ruoligiocatori: ~4 rows (approximately)
DELETE FROM `RUOLIGIOCATORI`;
/*!40000 ALTER TABLE `RUOLIGIOCATORI` DISABLE KEYS */;
INSERT INTO `RUOLIGIOCATORI` (`ID`, `NOME`) VALUES
	(1, 'PORTIERE'),
	(2, 'DIFENSORE'),
	(3, 'CENTROCAMPISTA'),
	(4, 'ATTACCANTE');
/*!40000 ALTER TABLE `RUOLIGIOCATORI` ENABLE KEYS */;


-- Dumping structure for table mark85rm_fantacalcio.ruoli_utenti
DROP TABLE IF EXISTS `RUOLI_UTENTI`;
CREATE TABLE IF NOT EXISTS `RUOLI_UTENTI` (
  `ID_RUOLO` INT(10) NOT NULL,
  `ID_UTENTE` BIGINT(10) NOT NULL,
  PRIMARY KEY (`ID_RUOLO`,`ID_UTENTE`),
  KEY `FK_RUOLI_UTENTI_U` (`ID_UTENTE`),
  CONSTRAINT `FK_RUOLI_UTENTI_R` FOREIGN KEY (`ID_RUOLO`) REFERENCES `RUOLI` (`ID`),
  CONSTRAINT `FK_RUOLI_UTENTI_U` FOREIGN KEY (`ID_UTENTE`) REFERENCES `UTENTI` (`ID`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

INSERT INTO `SQUADRE` (`CODICE`,`NOME` ) VALUES (1, 'SquadraAdmin');

INSERT INTO `UTENTI` (`ID`, `USERNAME`, `PASSWORD`, `NOME`, `COGNOME`, `MAIL`, `ENABLED`,  `SQUADRA`) VALUES (1, 'admin', 'admin', 'Amministratore', 'Amministratore', 'prova@gmail.com', 1, 1);

INSERT INTO `RUOLI_UTENTI` (`ID_RUOLO`, `ID_UTENTE`) VALUES (1, 1);
INSERT INTO `RUOLI_UTENTI` (`ID_RUOLO`, `ID_UTENTE`) VALUES (2, 1);



